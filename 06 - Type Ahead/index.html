<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Type Ahead ğŸ‘€</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <form class="search-form">
    <input type="text" class="search" placeholder="City or State">
    <ul class="suggestions">
      <li>Filter for a city</li>
      <li>or a state</li>
      
    </ul>
  </form>
<script>
const endpoint = 'https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json';

  // const prom=fetch(endpoint)
  // console.log(prom);
  // 1ã€è·å–æ•°æ®
  const citise =[]
  fetch(endpoint).then(response=> response.json())
  .then(data => citise.push(...data))

  // 2ã€ç­›é€‰æ•°æ®
  function filterData(words,citise){
    const newR=new RegExp(words,'gi')
    return citise.filter(data =>{
      return data.city.match(newR) || data.state.match(newR)
    })
  }

  // åˆ†å‰²æ•°ç»„çš„æ–¹æ³•
  function numberWith(x){
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g,',')
  }

  // 3ã€å±•ç¤ºæ•°æ®
  function showDate(){
    const showD =filterData(this.value,citise)
    const html=showD.map(data=>{
      // ä¸‹é¢ä¸‰è¡Œä»£ç çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†èƒ½å¤Ÿåœ¨æœç´¢çš„æ—¶å€™ï¼Œç»“æœé«˜äº®
      const regs=new RegExp(this.value,'gi')
      // é€šè¿‡ä½¿ç”¨replaceçš„æ–¹æ³•å°†è¾“å…¥æ¡†ä¸­çš„å†…å®¹æ›¿æ¢æˆé«˜äº®æ•ˆæœçš„æ ·å¼
      const cityName=data.city.replace(regs,`<span class="hl">${this.value}</span>`)
      const stateName=data.state.replace(regs,`<span class="hl">${this.value}</span>`)
      return `
        <li>
          <span class="name">${cityName} - ${stateName}</span>
          <span class="pupalation">${numberWith(data.population)}</span>
        </li>
      `
    }).join('')

    suggestions.innerHTML=html
  }

  const inputs=document.querySelector('.search')
  inputs.addEventListener('change',showDate)
  // ç»‘å®škeyupå¯ä»¥å®ç°å½“åœ¨æœç´¢çš„æ—¶å€™ï¼Œå®æ—¶æ˜¾ç¤ºå‡ºç›¸åº”çš„ç»“æœ
  inputs.addEventListener('keyup',showDate)
  const suggestions=document.querySelector('.suggestions')
</script>
</body>
</html>
